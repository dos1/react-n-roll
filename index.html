<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=1024" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <title>React'n'roll | Sebastian Krzyszkowiak, Front'n'roll #1, UsabilityTools</title>

        <meta name="author" content="Sebastian Krzyszkowiak" />

        <link href="http://fonts.googleapis.com/css?family=Open+Sans:regular,semibold,italic,italicsemibold|PT+Sans:400,700,400italic,700italic|PT+Serif:400,700,400italic,700italic" rel="stylesheet" />

        <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" />
        <link href="//cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.css" rel="stylesheet" />

        <link href="css/base.css" rel="stylesheet" />
        <link href="css/utc.css" rel="stylesheet" />
        <link href="css/guitar.css" rel="stylesheet" />
        

        <script src="https://fb.me/react-0.13.1.js"></script>
        <script src="https://fb.me/JSXTransformer-0.13.1.js"></script>
        <script src="js/fetch.js"></script>


        <link rel="shortcut icon" href="images/favicon.ico" />
    </head>

    <body class="impress-not-supported">

        <div class="fallback-message">
            <p>Your browser <b>doesn't support the features required</b> by impress.js, so you are presented with a simplified version of this presentation.</p>
            <p>For the best experience please use the latest <b>Chrome</b>, <b>Safari</b> or <b>Firefox</b> browser.</p>
        </div>

        <div id="impress">

            <section id="slide1" class="step slide">
                <header class="page-header huge text-center">
                    <h1>React.js</h1>
                    <h2>Introduction</h2>
                </header>
                <div class="author text-center">
                    <a href="http://dosowisko.net/" rel="author">Sebastian Krzyszkowiak</a>@<a href="https://github.com/UsabilityTools">UsabilityTools.com</a>
                </div>
                <footer class="page-footer text-right">
                    <small>
                        <time datetime="2015-03-25">March 25th, 2015</time><br/>
                        Poznań
                    </small>
                </footer>
            </section>

            <section id="slide2" class="step slide">
                <header class="page-header text-center">
                    <h2>What is React? *</h2>
                </header>

                <p>
                A JavaScript library for building user interfaces.
                </p>

                
                <footer class="page-footer text-right bottom">
									<small>
										* Facebook don't hurt me
									</small>
                </footer>
            </section>

            <section id="slide3" class="step slide subslide">
								<header class="page-header text-center">
									<h2>Why it's so special?</h2>
								</header>

                <p>
                    <ul>
											<li>it's fast</li>
											<li>it's simple</li>
											<li>it's flexible</li>
										</ul>
                </p>
            </section>

            <section id="slide4" class="step slide subslide">
                <p class="big center">
										It's not a framework!<br/><br/>
										<small>It's a library.</small>
                </p>
            </section>

            <section id="slide4.5" class="step slide">
                <p class="big center">
									<strong>Components</strong>
                </p>
            </section>
            
            <section id="slide5" class="step slide subslide">
                <header class="page-header text-center">
                    <h2>Components</h2>
                </header>

                <p class="text-center">
									<ul>
										<li>composable</li>
										<li>reusable</li>
										<li>maintainable</li>
										</ul>
                </p>
            </section>

            <section id="slide6" class="step slide subslide">
                <header class="page-header text-center">
                    <h2>Components</h2>
                </header>

                <pre class="code-listing">
                <code class="language-javascript">var Kitteh = React.createClass({
	render: function() {
		return (
			&lt;img src="https://aroundustyroads.files.wordpress.com/2014/01/kitten.png" /&gt;
		);
	}
});
React.render(
	&lt;Kitteh /&gt;,
	document.getElementById('a-place-for-kitteh')
);</code>
</pre>
            </section>

            <section id="slide7" class="step slide subslide">
                <p class="big center" id="a-place-for-kitteh">
                    
                </p>
            </section>

            <section id="slide8" class="step slide subslide">
            <pre class="code-listing" style="padding-top: 0; padding-bottom: 0;">
            <code class="language-javascript" style="font-size: 0.8em; padding: 0">render: function() {
	return (
		&lt;img src="(...)" /&gt;
	);
}</code>
</pre>
                <p class="text-center" style="margin-top: -50px; position: relative;">
                    <img src="http://www.quickmeme.com/img/45/4547755c16e559dfddad6f7a725e499f9ac9169e0f2683db0b1f805c48943723.jpg" height="500" />
                </p>
            </section>

            <section id="slide8.5" class="step slide subslide">
            <header class="page-header text-center">
            <h3>JSX</h3>
            </header>
            <pre class="code-listing" style="padding-top: 0; padding-bottom: 0;">
            <code class="language-javascript language-jsx" style="padding: 0">render: function() {
	return (
		&lt;img src="(...)" /&gt;
	);
}</code>
</pre>
            <pre class="code-listing" style="padding-top: 0; padding-bottom: 0;">
            <code class="language-javascript" style="padding: 0">render: function() {
	return (
		React.createElement('img', { src: "(...)" })
	);
}</code>
</pre>
            </section>            
            
            <section id="slide9" class="step slide subslide">
                <header class="page-header text-center">
                    <h2>Components</h2>
                </header>

                <p class="big center">
									Data flows <strong>one way</strong>!
                </p>
            </section>

            <section id="slide10" class="step slide subslide">
                <header class="page-header text-center">
                    <h2>Components</h2>
                </header>

                <pre class="code-listing">
                <code class="language-javascript">var GlowinKitteh = React.createClass({
	render: function() {
		return (
			&lt;img src="https://aroundustyroads.files.wordpress.com/2014/01/kitten.png" style={{ boxShadow: "0px 0px 100px " + this.props.color }} /&gt;
		);
	}
	});
React.render(
	&lt;GlowinKitteh color="magenta" /&gt;,
	document.getElementById('a-place-for-glowin-kitteh')
);</code>
</pre>
            </section>

            <section id="slide10.1" class="step slide subslide">
                <p class="big center" id="a-place-for-glowin-kitteh">
                </p>
            </section>

            <section id="slide10.2" class="step slide subslide">
            
            <pre class="code-listing" style="padding-top: 0; padding-bottom: 0">
            <code class="language-javascript">var RandomKitteh = React.createClass({

	componentDidMount: function() {
		var parseJson = function (response) {
			return response.json();
		};
		
		window.fetch("kitty.php").then(parseJson)
			.then((function (response) {
				if (this.isMounted()) {
					this.setState(response);
				}
			}).bind(this));
	},
	
	(...)</code>
						</pre>            
						</section>
            

            <section id="slide10.3" class="step slide xtraslide">
            
            <pre class="code-listing" style="padding-top: 0; padding-bottom: 0">
            <code class="language-javascript">
	(...)
	
	render: function() {
		return (this.state ? (
			&lt;div&gt;
				&lt;img src={ this.state.url } /&gt;
				&lt;p className="link">
					&lt;a target="_blank"
						href={ this.state.source }>
							{ this.state.source }
					&lt;/a>
				&lt;/p&gt;
			&lt;/div&gt;
		) : (
			&lt;p>Loading kitteh...&lt;/p&gt;
		));
	}
});</code>
						</pre>            
						</section>            
            
            
            <section id="slide-kitteh" class="step slide subslide">
							<p class="big center" id="a-place-for-random-kitteh">
							</p>
            </section>
            
            
            <section id="slide10.4" class="step slide subslide">
            
            <pre class="code-listing" style="padding-top: 0; padding-bottom: 0">
            <code class="language-javascript">var OneKitteh = React.createClass({
	handleClick: function() {
		var colors = ['magenta', 'yellow', 'lightgreen', 'blue', 'red', 'black'];
		var color = colors[Math.floor(Math.random() * colors.length)];
		this.setState({color: color });
	},

	render: function() {
		return (
			<div>
				<img src={ this.props.data.url } style={{ boxShadow: "0px 0px 100px " + (this.state ? this.state.color : "transparent") }} onClick={ this.handleClick } />
				<p className="link"><a target="_blank" href={ this.props.data.source }>{ this.props.data.source }</a></p>
			</div>
		);
	}
});</code>
						</pre>            
						</section>
						
						
            <section id="slide10.5" class="step slide xtraslide">
            
            <pre class="code-listing" style="padding-top: 0; padding-bottom: 0">
            <code class="language-javascript" style="font-size: 0.8em">var InteractiveKittehs = React.createClass({
	componentDidMount: function() {
		this.setState({kittehs: []});
		this.addKitteh();
	},
	
	render: function() {
		var link = (this.state &amp;&amp; this.state.loading) ? "Loading" : (&lt;span className="link"&gt;&lt;a onClick={ this.addKitteh }&gt;Moar kittehs!!!11one&lt;/a&gt; | &lt;a onClick={ this.clearKittehs }>Clear&lt;/a&gt;&lt;/span&gt;);
	
		return (this.state ? (
			&lt;div&gt;
				&lt;div className="kittehs-box"&gt;
					{ this.state.kittehs }
				&lt;/div&gt;
				{ link }
			&lt;/div&gt;
		) : (
			&lt;p&gt;Loading kitteh...&lt;/p&gt;
		));
	}
	
	clearKittehs: function() {
		this.setState({ kittehs: [] });
	},
	(...)</code>
						</pre>            
						</section>
            
            
            <section id="slide10.6" class="step slide xtraslide">
            
            <pre class="code-listing" style="padding-top: 0; padding-bottom: 0">
            <code class="language-javascript" style="font-size: 0.8em">(...)

	addKitteh: function() {

		var parseJson = function (response) {
			return response.json();
		};
		
		this.setState({loading: true});
		
		window.fetch("kitty.php").then(parseJson)
			.then((function (response) {
				if (this.isMounted()) {
					this.setState(
						{
			loading: false,
			kittehs: this.state.kittehs.concat(
	[ &lt;OneKitteh key={this.state.kittehs.length} data={response} /&gt; ]
			)
						}
					);
				}
				return false;
			}).bind(this));
	},

});</code>
						</pre>            
						</section>            
            
            <section id="slide-kittehs" class="step slide subslide">
							<p class="big center" id="a-place-for-kittehs">
							</p>
            </section>
            
            <section id="slide11.0" class="step slide">
							<header class="page-header text-center"><h2>Performance</h2></header>
							
							<p class="big center">What makes it so fast?</p>
            </section>
            
            <section id="slide12.1" class="step slide subslide">
            <header class="page-header text-center"><h2>Performance</h2></header>
            
            <p class="big center">Re-render each time some data changes.</p>
            
            </section>
            
            <section id="slide13.2" class="step slide subslide">
            <header class="page-header text-center"><h2>Performance</h2></header>
            
            <p class="big center">Virtual DOM and diffing</p>
            
            </section>
            
            <section id="slide13.3" class="step slide subslide">
            <header class="page-header text-center"><h2>Performance</h2></header>
            
            <ul><li>shouldComponentUpdate()</li><li>helpers for dealing with immutability
            
                        <pre class="code-listing" style="padding-top: 0; padding-bottom: 0">
            <code class="language-javascript">var newData = React.addons.update(myData, {
  x: {y: {z: {$set: 7}}},
  a: {b: {$push: [9]}}
});</code>
						</pre> 
            </li></ul>
            </section>
            
            <!--
            
            <section id="slide111" class="step slide">
                <header class="page-header text-center">
                    <h2>co dalej</h2>
                </header>

                <ul>
                    <li>stan - losowy kotek</li>
                    <li>handlery eventów - wylosuj kotka</li>
                    <li>why it's fast (full rerenders, virtual dom, diff)</li>
                    <li>componentDidMount, this.getDOMNode()</li>
                    <li>start making components - struny i nuty</li>
                    <li>pchanie danych w dół - grana nuta</li>
                    <li>pchanie danych do góry - wybór stroju</li>
                    <li>http://www.slideshare.net/AndrewHull/react-js-and-why-its-awesome?related=1</li>
                </ul>
            </section>
            
            <section id="slide1111" class="step slide">
            
            <div id="detector" class="vague">
            <div class="pitch"><span id="pitch">--</span>Hz</div>
            <div class="note"><span id="note">--</span></div>   
            <canvas id="output" width=300 height=42></canvas>
            <div id="detune"><span id="detune_amt">--</span><span id="flat">cents &#9837;</span><span id="sharp">cents &#9839;</span></div>
            </div>
            
            </section>
            
            -->
            <section id="slide30" class="step slide">
                <header class="page-header text-center">
                    <h2>Dev tools</h2>
                </header>

                <p class="big center"><img src="http://dosowisko.net/react.png" /></p>
            </section>
            
            
            <section id="slide31" class="step slide">

                <p class="big center">
                    <strong>Thank you!</strong><br>
                    <small style="font-size: 50%;">
                        <a href="http://dosowisko.net/" rel="author">Sebastian Krzyszkowiak</a>@<a href="https://github.com/UsabilityTools">UsabilityTools.com</a>
                    </small>
                </p>
            </section>

        </div>

        <aside class="content-index panel panel-default">
            <header class="page-header panel-header">
                <h2>Table of contents</h2>
            </header>

            <button type="button" class="btn btn-default content-index-trigger">
                <i class="glyphicon glyphicon-th"></i>
            </button>
            <nav class="panel-body content-index-list"></nav>
        </aside>

        <script src="//cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.js"></script>
        <script>
            var contentIndex = [ ];

            var subSlideIdx = 0, subSlideCount = 0, xtraSlideCount = 0, xtraSlideIdx = 0, lastHeader;

            Array.prototype.forEach.call(document.querySelectorAll('[id^="slide"]'), function(slide, index) {
                if (slide.classList.contains('subslide')) {
									subSlideIdx++;
									subSlideCount++;
									xtraSlideIdx = 0;
								} else if (slide.classList.contains('xtraslide')) {
									xtraSlideCount++;
									xtraSlideIdx++;
								} else {
									subSlideIdx = 0;
									xtraSlideIdx = 0;
                }

                slide.setAttribute('data-y', - ((index - subSlideCount - xtraSlideCount) * 600) + (xtraSlideIdx * 750));
                slide.setAttribute('data-x', ((index - xtraSlideCount) * 1000) + (subSlideCount * 150));
                slide.setAttribute('data-z', ((index - xtraSlideCount - subSlideCount) * 1500));

                var header = slide.querySelector('.page-header > h2');

                if (header && (header.innerHTML != lastHeader)) {
                    contentIndex.push({
                        title: header.innerHTML,
                        id: slide.getAttribute('id')
                    });
										
										lastHeader = header.innerHTML;
                }
            });

            document.querySelector('.content-index-list').innerHTML = (contentIndex.reduce(function(prev, curr) {
                return (prev + '<li class="content-index-list-item"><a href="#' + curr.id + '">' + curr.title + '</a></li>');
            }, '<ul class="nav nav-pills nav-stacked content-index-list">') + '</ul>');
        </script>
        <script src="js/impress.js"></script>
        <script>impress().init();</script>
        <script>
        /*
				 T he M*IT License (MIT)

				 Copyright (c) 2014 Chris Wilson

				 Permission is hereby granted, free of charge, to any person obtaining a copy
				 of this software and associated documentation files (the "Software"), to deal
				 in the Software without restriction, including without limitation the rights
				 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
				 copies of the Software, and to permit persons to whom the Software is
				 furnished to do so, subject to the following conditions:

				 The above copyright notice and this permission notice shall be included in all
				 copies or substantial portions of the Software.

				 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
				 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
				 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
				 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
				 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
				 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
				 SOFTWARE.
				 */
				(function() {

					var audioContext = null;
					var meter = null;
					var canvasContext = null;
					var WIDTH=500;
					var HEIGHT=50;
					var rafID = null;


					/*
					 *
					 * Usage:
					 * audioNode = createAudioMeter(audioContext,clipLevel,averaging,clipLag);
					 *
					 * audioContext: the AudioContext you're using.
					 * clipLevel: the level (0 to 1) that you would consider "clipping".
					 *   Defaults to 0.98.
					 * averaging: how "smoothed" you would like the meter to be over time.
					 *   Should be between 0 and less than 1.  Defaults to 0.95.
					 * clipLag: how long you would like the "clipping" indicator to show
					 *   after clipping has occured, in milliseconds.  Defaults to 750ms.
					 *
					 * Access the clipping through node.checkClipping(); use node.shutdown to get rid of it.
					 */

					function createAudioMeter(audioContext,clipLevel,averaging,clipLag) {
						var processor = audioContext.createScriptProcessor(512);
						processor.onaudioprocess = volumeAudioProcess;
						processor.clipping = false;
						processor.lastClip = 0;
						processor.volume = 0;
						processor.clipLevel = clipLevel || 0.98;
						processor.averaging = averaging || 0.95;
						processor.clipLag = clipLag || 250;

						// this will have no effect, since we don't copy the input to the output,
						// but works around a current Chrome bug.
						processor.connect(audioContext.destination);

						processor.checkClipping =
						function(){
							if (!this.clipping)
								return false;
							if ((this.lastClip + this.clipLag) < window.performance.now())
								this.clipping = false;

							return this.clipping;
						};

						processor.shutdown =
						function(){
							this.disconnect();
							this.onaudioprocess = null;
						};

						return processor;
					}

					function volumeAudioProcess( event ) {
						var buf = event.inputBuffer.getChannelData(0);
						var bufLength = buf.length;
						var sum = 0;
						var x;

						// Do a root-mean-square on the samples: sum up the squares...
						for (var i=0; i<bufLength; i++) {
							x = buf[i];
							if (Math.abs(x)>=this.clipLevel) {
								this.clipping = true;
								this.lastClip = window.performance.now();
							}
							sum += x * x;
						}

						// ... then take the square root of the sum.
						var rms =  Math.sqrt(sum / bufLength);

						// Now smooth this out with the averaging factor applied
						// to the previous sample - take the max here because we
						// want "fast attack, slow release."
						this.volume = Math.max(rms, this.volume*this.averaging);
					}

					window.onload = function() {

						// grab our canvas
						//canvasContext = document.getElementById( "meter" ).getContext("2d");

						// monkeypatch Web Audio
						window.AudioContext = window.AudioContext || window.webkitAudioContext;

						// grab an audio context
						audioContext = new AudioContext();

						// Attempt to get audio input
						try {
							// monkeypatch getUserMedia
							navigator.getUserMedia =
							navigator.getUserMedia ||
							navigator.webkitGetUserMedia ||
							navigator.mozGetUserMedia;

							// ask for an audio input
							navigator.getUserMedia(
								{
									"audio": {
										"mandatory": {
											"googEchoCancellation": "false",
											"googAutoGainControl": "false",
											"googNoiseSuppression": "false",
											"googHighpassFilter": "false"
										},
										"optional": []
									},
								}, gotStream, didntGetStream);
						} catch (e) {
							alert('getUserMedia threw exception :' + e);
						}

					}


					function didntGetStream() {
						alert('Stream generation failed.');
					}

					var mediaStreamSource = null;

					function gotStream(stream) {
						//startPitch();
						
						// Create an AudioNode from the stream.
						mediaStreamSource = audioContext.createMediaStreamSource(stream);

						// Create a new volume meter and connect it.
						meter = createAudioMeter(audioContext);
						mediaStreamSource.connect(meter);

						// kick off the visual updating
						drawLoop();
					}

					var lastNotClip = 0;

					function nextSlideChecker(clip) {
						//console.log(clip);
						if (!clip) lastNotClip = window.performance.now();
				 if (clip) {
					 if ((lastNotClip != 0) && (lastNotClip + 1000 < window.performance.now())) {
						 lastNotClip = 0;
						 if (!(document.body.classList.contains("guitarLocked"))) impress().next();
					 }
				 }
					}

					function drawLoop( time ) {
						// clear the background
						//canvasContext.clearRect(0,0,WIDTH,HEIGHT);

						// check if we're currently clipping
						if (meter.checkClipping()) {
							//canvasContext.fillStyle = "red";
							document.body.classList.add("clipping");
							nextSlideChecker(true);
						} else {
							//canvasContext.fillStyle = "green";
							document.body.classList.remove("clipping");
							nextSlideChecker(false);
						}

						// draw a bar based on the current volume
						//canvasContext.fillRect(0, 0, meter.volume*WIDTH*1.4, HEIGHT);

						// set up the next visual callback
						rafID = window.requestAnimationFrame( drawLoop );
					}
					
					window.addEventListener("keypress", function(ev) { 
						if (ev.which == 122) document.body.classList.toggle("guitarLocked");
					});

				})();
        </script>
        <script type="text/jsx" src="js/react.js"></script>
        <script src="pd/js/pitchdetect.js"></script>
    </body>
</html>
